function TTGallery(e){this.containerId=e;this.container=document.getElementById(this.containerId);this.container.style.filter="progid:DXImageTransform.Microsoft.Fade(duration=0.3, overlap=1.0)";this.container.style.textAlign="center";this.container.style.width="100%";this.container.instance=this;this.numImages=0;this.imageLoaded=0;this.offset=0;this.src=new Array;this.caption=new Array;this.width=new Array;this.height=new Array;this.imageCache=new Array;this.container=null}TTGallery.prototype.appendImage=function(e,t,n,r){this.numImages++;var i=new Image;i.src=e;this.imageCache[this.imageCache.length]=e;this.src[this.src.length]=e;this.width[this.width.length]=n;this.height[this.height.length]=r;this.caption[this.caption.length]=t};TTGallery.prototype.getControl=function(){var e=document.createElement("div");e.style.marginBottom="10px";e.className="galleryControl";e.style.font="bold 0.9em Verdana, Sans-serif";e.innerHTML="("+(this.offset+1)+"/"+this.numImages+') <a href="#" onclick="document.getElementById(\''+this.containerId+'\').instance.prev(); return false" style="border: 0px"><img src="'+servicePath+'/image/gallery/gallery_prev.gif" width="20" height="16" alt="PREVIOUS" style="vertical-align: middle"/></a> <a href="#" onclick="document.getElementById(\''+this.containerId+'\').instance.showImagePopup1(); return false" style="border: 0px"><img src="'+servicePath+'/image/gallery/gallery_enlarge.gif" width="70" height="19" alt="ZOOM" style="vertical-align: middle"/></a> <a href="#" onclick="document.getElementById(\''+this.containerId+'\').instance.next(); return false" style="border: 0px"><img src="'+servicePath+'/image/gallery/gallery_next.gif" width="20" height="16" alt="NEXT" style="vertical-align: middle"/></a>';return e};TTGallery.prototype.getImage=function(){var e=document.createElement("img");e.instance=this;e.src=this.src[this.offset];e.width=this.width[this.offset];e.height=this.height[this.offset];e.onclick=this.showImagePopup2;e.style.cursor="pointer";return e};TTGallery.prototype.getCaption=function(){var e=this.caption[this.offset];e=e.replace(new RegExp("&amp;?","gi"),"&");e=e.replace(new RegExp("&lt;?","gi"),"<");e=e.replace(new RegExp("&gt;?","gi"),">");e=e.replace(new RegExp("&quot;?","gi"),'"');e=e.replace(new RegExp("&#39;?","gi"),"'");var t=document.createElement("div");t.style.textAlign="center";t.style.marginTop="8px";t.className="galleryCaption";t.appendChild(document.createTextNode(e));return t};TTGallery.prototype.show=function(e){this.container=document.getElementById(this.containerId);if(this.numImages==0){var t=document.createElement("div");t.style.textAlign="center";t.style.color="#888";t.style.margin="10px auto";t.style.font="bold 2em/1 Verdana, Sans-serif";t.innerHTML='<img src="'+servicePath+'/image/noImages.gif" alt="No Images">';this.container.appendChild(t);this.container=null;return}typeof e=="undefined"?this.offset=0:e<0?this.offset=this.numImages-1:e>=this.numImages?this.offset=0:this.offset=e;this.container.filters&&this.container.filters[0].Apply();this.container.innerHTML="";this.container.appendChild(this.getControl());this.container.appendChild(this.getImage());this.container.appendChild(this.getCaption());this.container.filters&&this.container.filters[0].Play();this.container=null};TTGallery.prototype.prev=function(){this.show(this.offset-1)};TTGallery.prototype.next=function(){this.show(this.offset+1)};TTGallery.prototype.showImagePopup1=function(){this.showImagePopup()};TTGallery.prototype.showImagePopup2=function(){this.instance.showImagePopup()};TTGallery.prototype.showImagePopup=function(e){try{open_img(this.src[this.offset])}catch(t){window.open(this.src[this.offset])}};